<div class="row">
    <div class="large-6 medium-6 small-6 columns">
        <span style="font-size:0.8em;float:left;">
            <%= page_entries_info @disruptions %>
        </span>
    </div>
    <div class="large-6 medium-6 small-6 columns">
        <span style="font-size:0.8em;float:right;">
            <i>Last updated: <span id="lastUpdateTime" style="font-weight:bold;"><%= Time.new.strftime("%m/%d/%Y %H:%M:%S ") %></span></i>
        </span>
    </div>
</div>

<div class="row">
    <div class="large-12 columns">
        <table class="responsive" width="100%">
            <thead>
            <tr>
                <th>Route</th>
                <th>Direction</th>
                <th>
                    <span data-tooltip aria-haspopup="true" class="has-tip" title="Stops between which disruption is observed.">From stop</span>
                </th>
                <th>
                    <span data-tooltip aria-haspopup="true" class="has-tip" title="Stops between which disruption is observed.">To stop</span>
                </th>
                <th>
                    <span data-tooltip aria-haspopup="true" class="has-tip" title="WMA (Weighted moving average) disruption time in minutes using feeds from the last 2 hours.">Delay observed</span>
                </th>
                <th>
                    <span data-tooltip aria-haspopup="true" class="has-tip" title="Total delay observed across the route in minutes.">Total delay</span>
                </th>
                <th>
                    <span data-tooltip aria-haspopup="true" class="has-tip" title="If disruption is increasing (<span style=color:#FF5468;>&#8593;</span>) and if it normalising (<span style=color:#4DFA90;>&#8595;</span>) else (<span style=color:#FABE4D;>&#8597;</span>).">Trend</span>
                </th>
                <th>
                    <span data-tooltip aria-haspopup="true" class="has-tip" title="Time when the system has first alerted for the disruption.">Alerted at</span>
                </th>
                <th></th>
                <th>
                    <!-- <span data-tooltip aria-haspopup="true" class="has-tip" title="Ignore/hide disruption from table.">Hide</span>-->
                </th>
            </tr>
            </thead>
            <tbody>
            <% @disruptions.each do |disruption| %>
                <tr>
                    <td>
                        <a href="http://www.tfl.gov.uk/bus/route/<%= disruption.route %>/?direction=<%= disruption.direction %>" target="_blank"><%= disruption.route %></a>
                    </td>
                    <td> <%= disruption.direction %></td>
                    <!--<a href =" http://countdown.tfl.gov.uk/#%7CstopCode=%= disruption.startStopCode %>" target="_blank">%= disruption.startStop %></a>-->
                    <td>
                        <a href="http://countdown.tfl.gov.uk/#|searchTerm=<%= disruption.fromStopCode %>" target="_blank"><%= disruption.fromStopName %></a>
                    </td>
                    <td>
                        <a href="http://countdown.tfl.gov.uk/#|searchTerm=<%= disruption.toStopCode %>" target="_blank"><%= disruption.toStopName %></a>
                    </td>
                    <td class="delayCell <%= disruption.delayColor %>"><%= disruption.delay %></td>
                    <td class="delayCell <%= disruption.totalDelayColor %>"><%= disruption.routeTotalDelay %></td>
                    <td class="trendCell <%= disruption.trendColor %>"><%= raw(disruption.trendSymbol) %>
                    </td>
                    <td> <%= formatDatetimeString(disruption.timeFirstDetected) %></td>
                    <td><a href="#" data-reveal-id="disruptionDetails" class="tiny">More</a></td>
                    <td><a href="#" class="tiny disabled">Hide</a></td>
                </tr>
            <% end %>
            </tbody>
        </table>
        <% if @disruptions.total_entries > 20 %>
            <div class="apple_pagination">
                <%= will_paginate @disruptions, :container => false %>
            </div>
        <% end %>
    </div>
</div>

<%= render 'disruptionDetails' %>